var app=angular.module("budgetPro",["ui.router"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(n,t,i){t.otherwise("/login");i.html5Mode(!0);n.state("login",{url:"/login",templateUrl:"templates/login.html",controller:"LoginController"}).state("account",{url:"/account",templateUrl:"templates/account.html",controller:"AccountController"}).state("budget",{url:"/budget",templateUrl:"templates/budget.html",controller:"BudgetController"})}]);app.factory("budgetItem",["period",function(n){return function(t,i){return{name:t,type:i,currency:undefined,period:n.setPeriod(0,0,1,31,0,11,new Date)}}}]);app.factory("period",function(){return{setPeriod:function(n,t,i,r,u,f,e){return{frequency:n,dayOfWeek:t,dayOfMonth1:i,dayOfMonth2:r,month1:u,month2:f,periodStart:e}},periods:{frequency:[{id:0,name:"Daily"},{id:1,name:"Weekly"},{id:2,name:"Bi-Weekly"},{id:3,name:"Semi-Monthly"},{id:4,name:"Monthly"},{id:5,name:"Quarterly"},{id:6,name:"Semi-Annually"},{id:7,name:"Annually"}],daysOfWeek:[{id:0,name:"Sunday"},{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"}],daysOfMonth:[{id:1,name:"1st"},{id:2,name:"2nd"},{id:3,name:"3rd"},{id:4,name:"4th"},{id:5,name:"5th"},{id:6,name:"6th"},{id:7,name:"7th"},{id:8,name:"8th"},{id:9,name:"9th"},{id:10,name:"10th"},{id:11,name:"11th"},{id:12,name:"12th"},{id:13,name:"13th"},{id:14,name:"14th"},{id:15,name:"15th"},{id:16,name:"16th"},{id:17,name:"17th"},{id:18,name:"18th"},{id:19,name:"19th"},{id:20,name:"20th"},{id:21,name:"21st"},{id:22,name:"22nd"},{id:23,name:"23rd"},{id:24,name:"24th"},{id:25,name:"25th"},{id:26,name:"26th"},{id:27,name:"27th"},{id:28,name:"28th"},{id:29,name:"29th"},{id:30,name:"30th"},{id:31,name:"31st"}],months:[{id:0,name:"January"},{id:1,name:"February"},{id:2,name:"March"},{id:3,name:"April"},{id:4,name:"May"},{id:5,name:"June"},{id:6,name:"July"},{id:7,name:"August"},{id:8,name:"September"},{id:9,name:"October"},{id:10,name:"November"},{id:11,name:"December"}]}}});app.factory("prompt",["$compile",function(n){return{type:{alert:1,confirm:2,input:3},show:function(t,i,r,u,f){var h,e,o,s;h=n("<prompt>")(r);angular.element(document.body).append(h);switch(t){case 1:e="Alert";o="OK";break;case 2:e="Confirm";o="Yes";s="No";break;case 3:e="Input";o="OK";s="Cancel"}r.$$childTail.promptTitle=e;r.$$childTail.promptMessage=i;r.$$childTail.acceptLabel=o;r.$$childTail.declineLabel=s;r.$$childTail.acceptCallback=u;r.$$childTail.declineCallback=f}}}]);app.directive("prompt",function(){return{restrict:"E",scope:!0,templateUrl:"templates/prompt.html",link:function(n,t){function i(){n.$destroy();t.remove();r(!1)}function r(n){n?angular.element(document).find('input, button[type="button"], button[type="submit"], select').attr("disabled","disabled"):angular.element(document).find('input, button[type="button"], button[type="submit"], select').removeAttr("disabled")}r(!0);n.accept=function(){i();n.acceptCallback&&n.acceptCallback()};n.decline=function(){i();n.declineCallback&&n.declineCallback()}}}});app.directive("confirm",function(){return{require:"ngModel",scope:{confirm:"="},link:function(n,t,i,r){r.$validators.confirm=function(t){return t===n.confirm};n.$watch("confirm",function(){r.$validate()})}}});app.directive("password",function(){return{require:"ngModel",link:function(n,t,i,r){r.$validators.password=function(n){return n===""||n===undefined?!0:/^((?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,16})$/.test(n)?!0:!1}}}});app.factory("itemSets",function(){return{setItemSetText:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){return{legend:n,height:t,radioTitle:i,radio1:r,radio2:u,name:f,currency:e,frequency:o,weekly:s,biWeekly:h,periodStart:c,monthly:l,annually:a,add:v,itemName:y,currencyName:p}}}});app.directive("itemSets",function(){return{restrict:"E",controller:"AccountController",scope:{items:"=",itemText:"=",form:"="},templateUrl:"templates/itemSet.html"}});app.directive("setName",function(){return{scope:{setName:"@",nameIndex:"@",numItems:"@"},link:function(n,t,i){n.$watch("numItems",function(){i.$set("name",n.setName+n.nameIndex)})}}});app.controller("AccountController",["$scope","$http","prompt","period","budgetItem","itemSets",function(n,t,i,r,u,f){n.user={firstName:"",lastName:"",email:"",password:""};n.employers=[new u("",0)];n.employerText=f.setItemSetText("Employer",500,"Income Type:","Fixed Income","Variable Income","Employer Name","Net Pay","Pay Period Frequency:","This employer pays me every week on:","This employer pays me every other week on:","Enter a date when you've received payment from this employer or a date when you expect to be paid:","This employer pays me every month on the:","This employer pays me every year on:","Click to add an employer","employer","netPay");n.envelopes=[new u("Savings",1)];n.envelopeText=f.setItemSetText("Envelope",671,"Envelope Type:","Dynamic","Static","Envelope Name","Amount","Withdraw Frequency:","This envelope gets withdrawn every week on:","This envelope gets withdrawn every other week on:","Enter a date when this envelope has been withdrawn:","This envelope gets withdrawn every month on the:","This envelope gets withdrawn every year on:","Click to add an envelope","envelope","amount");n.periods=r.periods;n.addItem=function(n){n.push(new u("",0))};n.removeItem=function(t,r,u){var f,o,e;if(u==="envelope"){for(o=0,f=0;f<r.length;f++)r[f].type===1&&o++;if(o===1&&r[t].type===1){i.show(i.type.alert,"You need at least one static envelope.",n);return}}if(r.length===1){i.show(i.type.alert,"You need at least one "+u+".",n);return}e=[];i.show(i.type.confirm,"Are you sure you want to remove this "+u+"?",n,function(){angular.copy(r,e);e.splice(t,1);angular.copy(e,r)})};n.screenIndex=0;n.setScreen=function(t){var u=n.form,r=!0;if(t===1&&angular.forEach(u.$$controls,function(n){n.$validators.required&&(n.$name==="firstName"||n.$name==="lastName"||n.$name==="email"||n.$name==="confirmEmail"||n.$name==="password"||n.$name==="confirmPassword"||n.$name.substring(0,8)==="employer"||n.$name.substring(0,6)==="netPay")&&(n.$valid||(r=!1),n.$setTouched())}),!r){i.show(i.type.alert,"Oops! Some fields need your attention. All errors must be corrected before you can move on.",n);return}n.screenIndex=t};n.submit=function(){var r=n.form,u;if(!r.$valid){angular.forEach(r.$$controls,function(n){n.$validators.required&&n.$setTouched()});i.show(i.type.alert,"Oops! Some fields need your attention. All errors must be corrected before this form can be submitted.",n);return}u={params:{user:n.user,employers:n.employers,envelopes:n.envelopes}};t.get("../Account.asmx/CreateAccount",u).then(function(){},function(t){i.show(i.type.alert,t.statusText,n)})}}]);app.controller("LoginController",["$scope","loading","$state","prompt",function(n,t,i,r){n.email="";n.password="";n.login=function(){if(!n.form.$valid){angular.forEach(n.form.$$controls,function(n){n.$setTouched()});r.show(r.type.alert,"A valid email and password is required to log into your account.",n);return}t.set(!0);i.go("budget")};n.createAccount=function(){i.go("account")}}]);app.factory("loading",["$compile","$rootScope",function(n,t){return{set:function(i){var r;i?(r=n("<loading>")(t),angular.element(document.body).append(r)):angular.element(document).find("loading").remove()}}}]);app.directive("loading",function(){return{restrict:"E",templateUrl:"templates/loading.html",link:function(){angular.element(document).find('input, button[type="button"], button[type="submit"], select').attr("disabled","disabled")}}});app.controller("BudgetController",["$scope","loading",function(n,t){t.set(!1)}]);